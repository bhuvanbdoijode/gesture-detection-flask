<!DOCTYPE html>
<html>
<head>
    <title>Gesture Detection (Browser)</title>
    <style>
        body { text-align: center; background: #111; color: white; font-family: Arial; }
        video, canvas { border: 2px solid white; border-radius: 10px; margin-top: 20px; }
    </style>

    <!-- MediaPipe JS -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils"></script>
</head>

<body>
    <h1>Gesture Detection (Client-Side)</h1>

    <video id="video" width="640" height="480" autoplay playsinline></video>
    <canvas id="output" width="640" height="480"></canvas>

    <h2 id="gesture">Gesture: Detecting...</h2>

    <script>
        const videoElement = document.getElementById('video');
        const canvasElement = document.getElementById('output');
        const canvasCtx = canvasElement.getContext('2d');

        // Start camera
        async function startCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            videoElement.srcObject = stream;
        }
        startCamera();

        // MediaPipe Hands
        const hands = new Hands({
            locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
        });

        hands.setOptions({
            maxNumHands: 1,
            modelComplexity: 1,
            minDetectionConfidence: 0.7,
            minTrackingConfidence: 0.7
        });

        hands.onResults(results => {
            canvasCtx.save();
            canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
            canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);

            if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                for (const landmarks of results.multiHandLandmarks) {
                    drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS);
                    drawLandmarks(canvasCtx, landmarks);
                    detectGesture(landmarks);
                }
            }
            canvasCtx.restore();
        });

        const camera = new Camera(videoElement, {
            onFrame: async () => { await hands.send({ image: videoElement }); },
            width: 640,
            height: 480
        });
        camera.start();

        // Simple Gesture Detection Example
        function detectGesture(landmarks) {
    function isFingerUp(tip, pip) {
        return landmarks[tip].y < landmarks[pip].y;
    }

    const thumbUp = landmarks[4].y < landmarks[3].y;
    const indexUp = isFingerUp(8, 6);
    const middleUp = isFingerUp(12, 10);
    const ringUp = isFingerUp(16, 14);
    const pinkyUp = isFingerUp(20, 18);

    // âœ‹ PALM OPEN (all fingers up)
    if (thumbUp && indexUp && middleUp && ringUp && pinkyUp) {
        document.getElementById("gesture").innerText = "Gesture: ðŸ–ï¸ Open Palm";
        return;
    }

    // âœŠ FIST (no fingers up)
    if (!indexUp && !middleUp && !ringUp && !pinkyUp) {
        document.getElementById("gesture").innerText = "Gesture: âœŠ Fist";
        return;
    }

    // ðŸ‘ THUMBS UP (thumb up, others down)
    if (thumbUp && !indexUp && !middleUp && !ringUp && !pinkyUp) {
        document.getElementById("gesture").innerText = "Gesture: ðŸ‘ Thumbs Up";
        return;
    }

    // âœŒï¸ PEACE / VICTORY SIGN (index + middle)
    if (indexUp && middleUp && !ringUp && !pinkyUp) {
        document.getElementById("gesture").innerText = "Gesture: âœŒï¸ Victory";
        return;
    }

    // ðŸ‘‰ POINTING (index only)
    if (indexUp && !middleUp && !ringUp && !pinkyUp) {
        document.getElementById("gesture").innerText = "Gesture: ðŸ‘‰ Pointing";
        return;
    }

    document.getElementById("gesture").innerText = "Gesture: Detecting...";
}

    </script>
</body>
</html>
